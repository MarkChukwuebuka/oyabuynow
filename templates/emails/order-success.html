{% extends './partials/base.html' %}
{% load currency_filters %}
{% load static %}

{% block content %}
<table class="content-table" style="margin-top: 40px;" align="center" border="0" cellpadding="0"
  cellspacing="0" width="100%">
  <thead>
    <tr>
      <td align="center">
        <img src="{% static 'frontend/assets/images/order-success.png' %}" alt="Order Successful" style="width: 100px; height: auto;">
      </td>
    </tr>
  </thead>
</table>

<table class="content-table" style="margin-top: 30px;" align="center" border="0" cellpadding="0"
  cellspacing="0" width="100%">
  <thead>
    <tr style="display: block;">
      <td style="display: block;">
        <h3 style="font-weight: 700; font-size: 22px; margin: 0;">Thank you for your purchase, {{ customer_name|default:"Customer" }}!</h3>
      </td>
      <td style="display: block;">
        <p
          style="font-size: 17px; font-weight: 600; width: 80%; margin: 10px auto 0; line-height: 1.5; color: #939393;">
          Your order <strong>#{{ order_ref }}</strong> has been successfully placed. We’re currently processing
          it, and you’ll receive another email once it’s shipped.
        </p>
      </td>
    </tr>
  </thead>
</table>

<!-- Order Summary Table -->
<table class="order-summary" style="margin-top: 30px; border-collapse: collapse;" align="center" cellpadding="0"
  cellspacing="0" width="80%">
  <thead>
    <tr>
      <th align="left" style="border-bottom: 2px solid #ddd; padding: 10px 0; font-size: 16px;">Image</th>
      <th align="left" style="border-bottom: 2px solid #ddd; padding: 10px 0; font-size: 16px;">Item</th>
      <th align="center" style="border-bottom: 2px solid #ddd; padding: 10px 0; font-size: 16px;">Qty</th>
      <th align="right" style="border-bottom: 2px solid #ddd; padding: 10px 0; font-size: 16px;">Price</th>
    </tr>
  </thead>
  <tbody>
    {% for item in order.items.all %}
    <tr>
      <td style="padding: 10px 0; border-bottom: 1px solid #eee; color: #555;">
        {% with item.product.product_media.first as first_media %}
        {% if first_media %}
        <img
          src="{{ first_media.image.url }}"
          class="img-fluid blur-up lazyload"
          alt="{{ item.product.name }}"
        />
        {% endif %}
        {% endwith %}
      </td>
        <td style="padding: 10px 0; border-bottom: 1px solid #eee; color: #555;">
        {{ item.product.name }}
      </td>
      <td align="center" style="padding: 10px 0; border-bottom: 1px solid #eee; color: #555;">
        {{ item.quantity }}
      </td>
      <td align="right" style="padding: 10px 0; border-bottom: 1px solid #eee; color: #555;">
        {{ item.price|naira }}
      </td>
    </tr>
    {% endfor %}
  </tbody>
  <tfoot>
    <tr>
      <td colspan="2" align="right" style="padding: 10px 0; font-weight: 700; color: #333;">Subtotal:</td>
      <td align="right" style="padding: 10px 0; font-weight: 700; color: #333;">
        {{ order.total_cost | naira }}
      </td>
    </tr>
    {% if order_shipping %}
    <tr>
      <td colspan="2" align="right" style="padding: 5px 0; color: #333;">Shipping:</td>
      <td align="right" style="padding: 5px 0; color: #333;">
        {{ order_shipping|floatformat:2 }}
      </td>
    </tr>
    {% endif %}
    <tr>
      <td colspan="2" align="right" style="padding: 10px 0; font-weight: 700; font-size: 18px; color: #000;">Total:</td>
      <td align="right" style="padding: 10px 0; font-weight: 700; font-size: 18px; color: #000;">
        {{ order.total_cost | naira }}
      </td>
    </tr>
  </tfoot>
</table>

<table class="button-table" style="margin-top: 30px;" align="center" border="0" cellpadding="0"
  cellspacing="0" width="100%">
  <thead>
    <tr style="display: block;">
      <td style="display: block; text-align: center;">
        <a href="{% url 'order-detail' order.ref %}"
          style="background-color: #007bff; color: #fff; text-decoration: none; font-size: 17px; font-weight: 600; padding: 12px 25px; border-radius: 8px; display: inline-block;">
          View Your Order
        </a>
      </td>
    </tr>
  </thead>
</table>

<table class="content-table" style="margin-top: 30px;" align="center" border="0" cellpadding="0"
  cellspacing="0" width="100%">
  <thead>
    <tr style="display: block;">
      <td style="display: block;">
        <p
          style="font-size: 16px; font-weight: 600; width: 80%; margin: 8px auto 0; line-height: 1.6; color: #939393;">
          Your order will be shipped to:
          <br><br>
          <strong>{{ order.first_name }} {{ order.last_name }}</strong><br>
          {{ order.phone }}<br>
          {{ order.address }}<br>
          {{ order.lga }}, {{ order.state }}<br>
        </p>
      </td>
    </tr>
  </thead>
</table>

<table class="content-table" style="margin-top: 20px;" align="center" border="0" cellpadding="0"
  cellspacing="0" width="100%">
  <thead>
    <tr style="display: block;">
      <td style="display: block;">
        <p
          style="font-size: 16px; font-weight: 600; width: 80%; margin: 8px auto 0; line-height: 1.6; color: #939393;">
          If you have any questions or concerns, feel free to contact our support team at
          <a href="mailto:{{ support_email|default:'support@example.com' }}" style="color: #007bff; text-decoration: none;">{{ support_email|default:"support@example.com" }}</a>.
        </p>
      </td>
    </tr>
  </thead>
</table>
{% endblock content %}
